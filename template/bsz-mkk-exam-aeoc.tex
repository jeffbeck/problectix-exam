\renewcommand{\mytemplate}{bsz-mkk-exam}
\renewcommand*\contentsname{Prüfungsinhalt}
\newcommand{\projectname}{}

% remember the categorie of the problem before
% KT: 1
% KL: 2
% ET: 3
\newcounter{LatestCategory}
% remember WA/PF
% PF: 1
% WA: 2
\newcounter{LatestMust}

% counter Wahlaufgaben
\newcounter{ModeFinal}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% BT counters
% total time counters
\newcounter{TimeTotal}
\newcounter{TimeTotalOK}% Minuten Gesamt
\newcounter{TimeTotalOKdisplay}% Minuten Gesamt anzuzeigen

\newcounter{TimeTotalET}
\newcounter{TimeTotalETOK}% Minuten Elektrotechnik

\newcounter{TimeTotalKT}
\newcounter{TimeTotalKTOK}% Minuten Kältetechnik

\newcounter{TimeTotalKL}
\newcounter{TimeTotalKLOK}% Minuten Klimatechnik

\newcounter{TimeTotalPF}
\newcounter{TimeTotalPFOK}% Minuten Pflichtaufgaben

\newcounter{TimeTotalWA}
\newcounter{TimeTotalWAOK}% Minuten Wahlaufgaben
\newcounter{TimeTotalWAOKdisplay}% Minuten Wahlaufgaben anzuzeigen

\newcounter{TimeWAError}
\newcounter{TimeWAErrorOK}
\newcounter{TimeWAOK}
\setcounter{TimeWAOK}{10}% Minuten einer Wahlaufgabe

% other counters
\newcounter{NumberTotalWA}
\newcounter{NumberTotalWAOK}% Anzahl Wahlaufgaben
\newcounter{NumberTotalWASelect}% Anzahl zu wählender Wahlaufgaben

% count how often TopicTime<TOPIC> was updated
\newcounter{NumberTopicsCounted}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% TopicTimeCounter
% TopicTimeTOPICNAME
% HLOGP
\newcounter{TopicTimeHLOGP}
\newcounter{TopicTimeHLOGPMin}
% HX
\newcounter{TopicTimeHX}
\newcounter{TopicTimeHXMin}
% RI
\newcounter{TopicTimeRI}
\newcounter{TopicTimeRIMin}
% KTFUNKTION
\newcounter{TopicTimeKTFUNKTION}
\newcounter{TopicTimeKTFUNKTIONMin}
% WU
\newcounter{TopicTimeWU}
\newcounter{TopicTimeWUMin}
% VERDICHTER
\newcounter{TopicTimeVERDICHTER}
\newcounter{TopicTimeVERDICHTERMin}
% LUFT
\newcounter{TopicTimeLUFT}
\newcounter{TopicTimeLUFTMin}
% MOP
\newcounter{TopicTimeMOP}
\newcounter{TopicTimeMOPMin}
% ABTAUUNG
\newcounter{TopicTimeABTAUUNG}
\newcounter{TopicTimeABTAUUNGMin}
% COP
\newcounter{TopicTimeCOP}
\newcounter{TopicTimeCOPMin}
% KUEHLTURM
\newcounter{TopicTimeKUEHLTURM}
\newcounter{TopicTimeKUEHLTURMMin}
% ROHR
\newcounter{TopicTimeROHR}
\newcounter{TopicTimeROHRMin}
% ET
% SCHALTUNG
\newcounter{TopicTimeSCHALTUNG}
\newcounter{TopicTimeSCHALTUNGMin}
% SCHALTPLAN
\newcounter{TopicTimeSCHALTPLAN}
\newcounter{TopicTimeSCHALTPLANMin}
% MOTOR
\newcounter{TopicTimeMOTOR}
\newcounter{TopicTimeMOTORMin}
% DREHSTROM
\newcounter{TopicTimeDREHSTROM}
\newcounter{TopicTimeDREHSTROMMin}
% ETSCHUTZ
\newcounter{TopicTimeETSCHUTZ}
\newcounter{TopicTimeETSCHUTZMin}
% ZP
% KREISLAUF
\newcounter{TopicTimeKREISLAUF}
\newcounter{TopicTimeKREISLAUFMin}
% PRESSOSTAT
\newcounter{TopicTimePRESSOSTAT}
\newcounter{TopicTimePRESSOSTATMin}
% REFRIG
\newcounter{TopicTimeREFRIG}
\newcounter{TopicTimeREFRIGMin}
% GESLAENGE
\newcounter{TopicTimeGESLAENGE}
\newcounter{TopicTimeGESLAENGEMin}
% ISOMETRIE
\newcounter{TopicTimeISOMETRIE}
\newcounter{TopicTimeISOMETRIEMin}
% WAERME
\newcounter{TopicTimeWAERME}
\newcounter{TopicTimeWAERMEMin}
% ETBASIS
\newcounter{TopicTimeETBASIS}
\newcounter{TopicTimeETBASISMin}
% ETSYMBOLE
\newcounter{TopicTimeETSYMBOLE}
\newcounter{TopicTimeETSYMBOLEMin}
% ETKOSTEN
\newcounter{TopicTimeETKOSTEN}
\newcounter{TopicTimeETKOSTENMin}



% setzen der Zähler mit ... \BTone oder \BTtwo
\newcommand{\ExamWhich}{--- none ---}


% BT1
\newcommand{\BTone}[1]{
\School{BSZ Leonberg}
\Titelu{Berufstheorie \MakeUppercase{\romannumeral 1}}
\Beruf{Mechatroniker/-in für Kältetechnik}
\Bereich{Kältetechnik}
%
\ifthenelse{\equal{#1}{final}}{\setcounter{ModeFinal}{1}}{} 
\renewcommand{\ExamWhich}{\textbf{BT\,1}}
% counters
\setcounter{TimeTotalOK}{130}% incl. aller Wahlaufgaben
\setcounter{TimeTotalOKdisplay}{120}
\setcounter{TimeTotalETOK}{0}
\setcounter{TimeTotalKTOK}{130}
\setcounter{TimeTotalKLOK}{0}
\setcounter{TimeTotalWAOK}{30}
\setcounter{TimeTotalWAOKdisplay}{20}
\setcounter{TimeTotalPFOK}{100}
\setcounter{NumberTotalWAOK}{3}
\setcounter{NumberTotalWASelect}{2}
\setcounter{TimeWAErrorOK}{0}
% TopicTime counters
% KT
\setcounter{TopicTimeHLOGPMin}{20}
\setcounter{TopicTimeHXMin}{0}
\setcounter{TopicTimeRIMin}{20}
\setcounter{TopicTimeKTFUNKTIONMin}{0}
\setcounter{TopicTimeWUMin}{20}
\setcounter{TopicTimeVERDICHTERMin}{20}
\setcounter{TopicTimeLUFTMin}{0}
\setcounter{TopicTimeMOPMin}{0}
\setcounter{TopicTimeABTAUUNGMin}{0}
\setcounter{TopicTimeCOPMin}{0}
\setcounter{TopicTimeKUEHLTURMMin}{0}
\setcounter{TopicTimeROHRMin}{0}
% ET
\setcounter{TopicTimeSCHALTUNGMin}{0}
\setcounter{TopicTimeSCHALTPLANMin}{0}
\setcounter{TopicTimeMOTORMin}{0}
\setcounter{TopicTimeDREHSTROMMin}{0}
\setcounter{TopicTimeETSCHUTZMin}{0}
% ZP KT
\setcounter{TopicTimeKREISLAUFMin}{0}
\setcounter{TopicTimePRESSOSTATMin}{0}
\setcounter{TopicTimeREFRIGMin}{0}
\setcounter{TopicTimeGESLAENGEMin}{0}
\setcounter{TopicTimeISOMETRIEMin}{0}
\setcounter{TopicTimeWAERMEMin}{0}
% ZP ET
\setcounter{TopicTimeETBASISMin}{0}
\setcounter{TopicTimeETSYMBOLEMin}{0}
\setcounter{TopicTimeETKOSTENMin}{0}
}


% BT2
\newcommand{\BTtwo}[1]{
\School{BSZ Leonberg}
\Titelu{Berufstheorie \MakeUppercase{\romannumeral 2}}
\Beruf{Mechatroniker/-in für Kältetechnik}
\Bereich{Kälte- und Klimatechnik}
%
\ifthenelse{\equal{#1}{final}}{\setcounter{ModeFinal}{1}}{} 
\renewcommand{\ExamWhich}{\textbf{BT\,2}}
% counters
\setcounter{TimeTotalOK}{130}
\setcounter{TimeTotalOKdisplay}{120}
\setcounter{TimeTotalETOK}{60}
\setcounter{TimeTotalKTOK}{0}
\setcounter{TimeTotalKLOK}{40}
\setcounter{TimeTotalWAOK}{30}
\setcounter{TimeTotalWAOKdisplay}{20}
\setcounter{TimeTotalPFOK}{100}
\setcounter{NumberTotalWAOK}{3}
\setcounter{NumberTotalWASelect}{2}
\setcounter{TimeWAErrorOK}{0}
% TopicTime counters
% KT
\setcounter{TopicTimeHLOGPMin}{0}
\setcounter{TopicTimeHXMin}{20}
\setcounter{TopicTimeRIMin}{0}
\setcounter{TopicTimeKTFUNKTIONMin}{0}
\setcounter{TopicTimeWUMin}{0}
\setcounter{TopicTimeVERDICHTERMin}{0}
\setcounter{TopicTimeLUFTMin}{20}
\setcounter{TopicTimeMOPMin}{0}
\setcounter{TopicTimeABTAUUNGMin}{0}
\setcounter{TopicTimeCOPMin}{0}
\setcounter{TopicTimeKUEHLTURMMin}{0}
\setcounter{TopicTimeROHRMin}{0}
% ET
\setcounter{TopicTimeSCHALTUNGMin}{20}
\setcounter{TopicTimeSCHALTPLANMin}{20}
\setcounter{TopicTimeMOTORMin}{20}
\setcounter{TopicTimeDREHSTROMMin}{20}
\setcounter{TopicTimeETSCHUTZMin}{20}
% ZP KT
\setcounter{TopicTimeKREISLAUFMin}{0}
\setcounter{TopicTimePRESSOSTATMin}{0}
\setcounter{TopicTimeREFRIGMin}{0}
\setcounter{TopicTimeGESLAENGEMin}{0}
\setcounter{TopicTimeISOMETRIEMin}{0}
\setcounter{TopicTimeWAERMEMin}{0}
% ZP ET
\setcounter{TopicTimeETBASISMin}{0}
\setcounter{TopicTimeETSYMBOLEMin}{0}
\setcounter{TopicTimeETKOSTENMin}{0}
}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% commands
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \examinfo
% zusatzbefehl in aufgabenumgebung
\newcounter{ExamInfo}
\setcounter{ExamInfo}{0}
\newcommand{\examinfo}[4]{
% step a counter to check if this command is issued in every aufgabe
\stepcounter{ExamInfo}
% step other counters 
% time counter in min
\addtocounter{TimeTotal}{#1}
% KT/KL/ET
\ifthenelse{\equal{#2}{KT}}{\addtocounter{TimeTotalKT}{#1}}{} 
\ifthenelse{\equal{#2}{KL}}{\addtocounter{TimeTotalKL}{#1}}{} 
\ifthenelse{\equal{#2}{ET}}{\addtocounter{TimeTotalET}{#1}}{} 
%
% WA/PF
\ifthenelse{\equal{#3}{WA}}{\addtocounter{TimeTotalWA}{#1}}{} 
\ifthenelse{\equal{#3}{PF}}{\addtocounter{TimeTotalPF}{#1}}{} 
% Minuten Wahlaufgaben OK 
\ifthenelse{\equal{#3}{WA}}{%
    \ifthenelse{\value{TimeWAOK}=#1}{}{\stepcounter{TimeWAError}}
}{} 
% Anzahl Wahlaufgaben OK 
\ifthenelse{\equal{#3}{WA}}{\stepcounter{NumberTotalWA}}{}
%
% TopicTime counter
\ifthenelse{\equal{#4}{HLOGP}}{\addtocounter{TopicTimeHLOGP}{#1}\stepcounter{NumberTopicsCounted}}{} 
\ifthenelse{\equal{#4}{HX}}{\addtocounter{TopicTimeHX}{#1}\stepcounter{NumberTopicsCounted}}{} 
\ifthenelse{\equal{#4}{RI}}{\addtocounter{TopicTimeRI}{#1}\stepcounter{NumberTopicsCounted}}{} 
\ifthenelse{\equal{#4}{KTFUNKTION}}{\addtocounter{TopicTimeKTFUNKTION}{#1}\stepcounter{NumberTopicsCounted}}{} 
\ifthenelse{\equal{#4}{WU}}{\addtocounter{TopicTimeWU}{#1}\stepcounter{NumberTopicsCounted}}{} 
\ifthenelse{\equal{#4}{VERDICHTER}}{\addtocounter{TopicTimeVERDICHTER}{#1}\stepcounter{NumberTopicsCounted}}{} 
\ifthenelse{\equal{#4}{LUFT}}{\addtocounter{TopicTimeLUFT}{#1}\stepcounter{NumberTopicsCounted}}{} 
\ifthenelse{\equal{#4}{MOP}}{\addtocounter{TopicTimeMOP}{#1}\stepcounter{NumberTopicsCounted}}{} 
\ifthenelse{\equal{#4}{ABTAUUNG}}{\addtocounter{TopicTimeABTAUUNG}{#1}\stepcounter{NumberTopicsCounted}}{} 
\ifthenelse{\equal{#4}{COP}}{\addtocounter{TopicTimeCOP}{#1}\stepcounter{NumberTopicsCounted}}{} 
\ifthenelse{\equal{#4}{KUEHLTURM}}{\addtocounter{TopicTimeKUEHLTURM}{#1}\stepcounter{NumberTopicsCounted}}{} 
\ifthenelse{\equal{#4}{ROHR}}{\addtocounter{TopicTimeROHR}{#1}\stepcounter{NumberTopicsCounted}}{} 
\ifthenelse{\equal{#4}{SCHALTUNG}}{\addtocounter{TopicTimeSCHALTUNG}{#1}\stepcounter{NumberTopicsCounted}}{} 
\ifthenelse{\equal{#4}{SCHALTPLAN}}{\addtocounter{TopicTimeSCHALTPLAN}{#1}\stepcounter{NumberTopicsCounted}}{} 
\ifthenelse{\equal{#4}{MOTOR}}{\addtocounter{TopicTimeMOTOR}{#1}\stepcounter{NumberTopicsCounted}}{} 
\ifthenelse{\equal{#4}{DREHSTROM}}{\addtocounter{TopicTimeDREHSTROM}{#1}\stepcounter{NumberTopicsCounted}}{} 
\ifthenelse{\equal{#4}{ETSCHUTZ}}{\addtocounter{TopicTimeETSCHUTZ}{#1}\stepcounter{NumberTopicsCounted}}{} 
\ifthenelse{\equal{#4}{KREISLAUF}}{\addtocounter{TopicTimeKREISLAUF}{#1}\stepcounter{NumberTopicsCounted}}{} 
\ifthenelse{\equal{#4}{PRESSOSTAT}}{\addtocounter{TopicTimePRESSOSTAT}{#1}\stepcounter{NumberTopicsCounted}}{} 
\ifthenelse{\equal{#4}{REFRIG}}{\addtocounter{TopicTimeREFRIG}{#1}\stepcounter{NumberTopicsCounted}}{} 
\ifthenelse{\equal{#4}{GESLAENGE}}{\addtocounter{TopicTimeGESLAENGE}{#1}\stepcounter{NumberTopicsCounted}}{} 
\ifthenelse{\equal{#4}{ISOMETRIE}}{\addtocounter{TopicTimeISOMETRIE}{#1}\stepcounter{NumberTopicsCounted}}{} 
\ifthenelse{\equal{#4}{WAERME}}{\addtocounter{TopicTimeWAERME}{#1}\stepcounter{NumberTopicsCounted}}{} 
\ifthenelse{\equal{#4}{ETBASIS}}{\addtocounter{TopicTimeETBASIS}{#1}\stepcounter{NumberTopicsCounted}}{} 
\ifthenelse{\equal{#4}{ETSYMBOLE}}{\addtocounter{TopicTimeETSYMBOLE}{#1}\stepcounter{NumberTopicsCounted}}{} 
\ifthenelse{\equal{#4}{ETKOSTEN}}{\addtocounter{TopicTimeETKOSTEN}{#1}\stepcounter{NumberTopicsCounted}}{} 
}



% \Beruf
\newcommand{\berufuse}[2][]{
  \ifthenelse{\value{debuggen}=1}{%
    \hspace{-1ex}\textcolor{red}{\texttt{\textbackslash Beruf\{\}\hspace{-1ex}}}%
  }{\xspace}
}
\newcommand{\Beruf}[2][]{%
  \ifthenelse{\value{debuggen}=1}{}{\renewcommand{\berufuse}[2][]{#2}}
}

% \Bereich
\newcommand{\bereichuse}[2][]{
  \ifthenelse{\value{debuggen}=1}{%
    \hspace{-1ex}\textcolor{red}{\texttt{\textbackslash Bereich\{\}\hspace{-1ex}}}%
  }{\xspace}
}
\newcommand{\Bereich}[2][]{%
  \ifthenelse{\value{debuggen}=1}{}{\renewcommand{\bereichuse}[2][]{#2}}
}



% \inputproject
\newcommand{\inputproject}[1]{
    \renewcommand{\projectname}{#1}
    \section*{Projektbeschreibung}\addtocontents{toc}{\vspace{3mm}\textbf{Projektbeschreibung}\par\vspace{2mm}}
    \nehme{../projects/#1/#1.tex}
}



% \inputproblem
\newcommand{\inputproblem}[1]{
    \nehme{../projects/\projectname/#1.tex}
}



% \inputcommon
\newcommand{\inputcommon}[1]{
    \nehme{../common/#1.tex}
}

% \projectincludegraphics
\newcommand{\projectincludegraphics}[2][]{
    \includegraphics[#1]{../projects/\projectname/#2}\label{#2}
}

% \commonincludegraphics
\newcommand{\commonincludegraphics}[2][]{
    \includegraphics[#1]{../common/#2}\label{#2}
}



% \projectsection
\newcommand{\projectsection}[1]{
\subsection*{#1}\addtocontents{toc}{\hspace{5mm}#1\dotfill Seite \thepage\par}
}

% \projectanhang
\newcommand{\projectanhang}[3][]{%
   %% counting the references in the main material
   \stepcounter{mainpage}%
   \Alph{mainpage}% this is printed
   \AtEndDocument{%
      \stepcounter{apppage}
      \addtocontents{toc}{Anhang \Alph{apppage}: \, #2 \dotfill Seite \thepage \par}
      \ifthenelse{\value{xlsg}=1}{% green
          \chead{\textcolor{xlsgcolor}{\textbf{Anhang \Alph{apppage}: #2}}\hspace{20mm}}
      }{% black
          \chead{\textbf{Anhang \Alph{apppage}: #2}\hspace{20mm}}
      }
      \vspace*{\fill}
      %% dirty hack to keep the graphic on one page, when textheight 
      \enlargethispage{4mm}
      \vspace{-12mm}
      %% dirty hack end
      \begin{center}\label{#3}\label{\Alph{apppage}}
      \ifthenelse{\equal{#1}{}}{
          \includepsfraggraphics
            [width=\textwidth,height=\textheight,keepaspectratio]{../projects/\projectname/#3}
      }{\includepsfraggraphics[#1]{../projects/\projectname/#3}}
      \end{center}
      \vspace*{\fill}
      \clearpage
      \AtEndDocument{% von lastpage.sty angepasst an verylastpage
      \message{AED: command anhang is setting a label for verylastpage}%
      \clearpage\verylastpage@putlabel}%
   }%
}


\newcommand{\xprojectanhang}[4][]{%
   \ifthenelse{\value{xlsg}=1}{%
      \projectanhang[#1]{#2}{#4}%
   }{%
      \projectanhang[#1]{#2}{#3}%
   }
}






%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% environments
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \begin{examaufgabe}
% \end{examaufgabe}
\newenvironment{examaufgabe}[6][]{%% Begin \begin
\examinfo{#3}{#4}{#5}{#6}%
% tableofcontents-header if WA,PF is switched
\ifthenelse{\equal{#5}{PF}}{%
    \ifthenelse{\theLatestMust=1}%
               {}%
               {\pagebreak\section*{Teil 1: Projekt-Pflichtaufgaben (\theTimeTotalPFOK{} Minuten)}\addtocontents{toc}{\vspace{3mm}\textbf{Teil 1: Projekt-Pflichtaufgaben} (\theTimeTotalPFOK{} Minuten)\par}}\setcounter{LatestMust}{1}%
}{}%
\ifthenelse{\equal{#5}{WA}}{%
    \ifthenelse{\theLatestMust=2}%
               {}%
               {\pagebreak\section*{Teil 2: Wahlaufgaben (\theTimeTotalWAOKdisplay{} Minuten, \theNumberTotalWASelect{} von \theNumberTotalWAOK{} Aufgaben sind zu bearbeiten)}%
                \addtocontents{toc}{\vspace{3mm}\textbf{Teil 2: Wahlaufgaben} (\theTimeTotalWAOKdisplay{} Minuten, \theNumberTotalWASelect{} von \theNumberTotalWAOK{} Aufg. bearbeiten)\par}}\setcounter{LatestMust}{2}%
}{}%  
% tableofcontents-header if KT,KL,ET is switched
\ifthenelse{\equal{#4}{KT}}{%
    \ifthenelse{\theLatestCategory=1}%
               {}%
               {\subsection*{Kältetechnik}\addtocontents{toc}{\vspace{2mm}\hspace{5mm}\textbf{Kältetechnik}\par}}\setcounter{LatestCategory}{1}%
}{}%  
\ifthenelse{\equal{#4}{KL}}{%
    \ifthenelse{\theLatestCategory=2}%
               {}%
               {\subsection*{Klimatechnik}\addtocontents{toc}{\vspace{2mm}\hspace{5mm}\textbf{Klimatechnik}\par}}\setcounter{LatestCategory}{2}%
}{}% 
\ifthenelse{\equal{#4}{ET}}{%
    \ifthenelse{\theLatestCategory=3}%
               {}%
               {\subsection*{Elektrotechnik}\addtocontents{toc}{\vspace{2mm}\hspace{5mm}\textbf{Elektrotechnik}\par}}\setcounter{LatestCategory}{3}%
}{}%  
% tableofcontents of problem
\addtocontents{toc}{\hspace{10mm}Aufgabe \theaufgabennummer: #2 (#3 min)\dotfill Seite \thepage\par}
% call aufgabe environment
\ifthenelse{\value{ModeFinal}=1}%
  {\begin{aufgabe}[#1]{#2 \hfill (#3 Minuten)}}% final
  {\begin{aufgabe}[#1]{#2 \hfill \textcolor{gruen}{#3min #4 #5 #6}}}% draft
%
%--- 1: #1 --- 2: #2 --- 3: #3 --- 4: #4 --- 5: #5 --- 6: #6 ---
%
}%
{%
\end{aufgabe}%
}%
